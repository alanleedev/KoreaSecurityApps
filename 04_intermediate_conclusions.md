# 한국의 금융보안: 중간 결론

 
얼마 전에 [한국의 특이한 온라인 보안에 대한 접근에 대해 첫 글](https://palant.info/2023/01/02/south-koreas-online-security-dead-end/)을 썼다.
거기에 이어서 [특정](https://palant.info/2023/01/09/touchen-nxkey-the-keylogging-anti-keylogger-solution/) [애플리케이션](https://palant.info/2023/01/25/ipinside-koreas-mandatory-spyware/) 두 개를 분석한 글을 썼다.
아직 더 쓸 글이 남아있지만 이것만으로도 충분히 중간 결론을 도출해 낼 수 있다.

가장 중요한 질문은 다음과 같다: 모든 보안 문제나 잘못된 관행를 제쳐두더라도 이러한 금융보안에 대한 접근이 맞는가?
이 애플리케이션이 전국에 의무적으로 설치하도록 했을 때 사용자들에게 더 나은 보안을 제공하는가?

![www.citibank.co.kr 에서 보이는 메시지: 서비스를 안전히 사용하기 위해서 [IP 로거] 프로그램을 설치해야 합니다. 설치 페이지로 이동할까요?](https://palant.info/2023/02/20/south-koreas-banking-security-intermediate-conclusions/message.png)


요약하자면: 내 생각으로는 위의 질문에 대한 답은 명확히 ‘아니오'이다. 실제 공격 시나리오를 고려했을 때 현재 접근방법은 그다지 이해가 되지 않는다. 이것은 실제 보안을 제공하는 것보다는 보안 극장(security theater)을 연출하는 것과 다름이 없다.
보안 극장은 가끔 유용할 수 있으나, 문제가 되고 있는 이슈에 대해서는 보다 적절할 해결책이 존재한다.

#### 목차

-   #엔드포인트-보안
-   #키보드-보안
-   #IP주소-감지
-   #인증서-기반-로그인
-   #소프트웨어-배포

## 엔드포인트 보안 (Endpoint protection)

가장 논란의 여지가 적은 부분은 사용자의 디바이스는 보호가 필요하다는 것이며 이상적으로는 악의적 사용을 막는 것이다.
그래서 사용자가 은행 웹사이트 접속할 때 다른 사람의 은밀한 감시없이 혼자 사용할 수 있어야 한다.
이러한 목적을 이루기 위해 두 종류의 애플리케이션이 등장했다.
백신과 방화벽이다. 

하지만 마이크로소프트가 이것을 지원하고 있다.
윈도우 7부터 아주 효과적인 방화벽 (윈도우 방화벽)과 괜찮은 백신 (윈도우 디펜더)을 내장하고 있다.
윈도우 자체에서 보호해주니 타사 백신을 설치한다고 반드시 더 안전해 지는 것은 아니다.
사실 이런 타사 백신 애플리케이션이 [자주](https://palant.info/2019/10/28/avast-online-security-and-avast-secure-browser-are-spying-on-you/) [보안](https://palant.info/2020/06/22/exploiting-bitdefender-antivirus-rce-from-any-website/)을 [더](https://palant.info/2019/08/19/kaspersky-in-the-middle--what-could-possibly-go-wrong/) [약화](https://palant.info/2020/01/13/pwning-avast-secure-browser-for-fun-and-profit/)하기도 [한다](https://palant.info/2020/02/25/mcafee-webadvisor-from-xss-in-a-sandboxed-browser-extension-to-administrator-privileges/).


물론 안랩의 백신이 얼마나 효과적인지는 개인적으로 잘 알지 못한다.
어쩌면 윈도우 디펜더 보다 아주 뛰어날 수도 있다.
그렇다면 한국의 은행 웹사이트에서 안랩 세이프 트랜잭션의 설치를 강제하는 것이 당연한가?

안랩 세이프 트랜잭션은 대부분 백그라운드에서 가만히 있다 은행 웹사이트에 접속해야만 동작한다.
다른 말로 컴퓨터를 공격으로부터 보호하지 못한다.
보통 맬웨어 감염은 은행 웹사이트에서 일어나지 않는다.
뭔가 조치를 취하려고 할 때는 이미 늦었을 것이다.

## 키보드 보안

한국의 여러 “보안” 애플리케이션이 키보드 입력을 보호하려한다.
이것은 컴퓨터는 이미 보안이 뚫렸을 경우 키보드 입력을 암호화해 웹사이트에 전달해 유해 애플리케이션이 보지 못하게 한다는 생각이다. 

이러한 솔루션 중 [TouchEn nxKey에 대해 자세히 살펴보았다](https://palant.info/2023/01/09/touchen-nxkey-the-keylogging-anti-keylogger-solution/).

> nkKey가 제공하는 보안이 무엇이든 공격자가 nxKey의 존재와 기능을 모르고 있다는 사실에 의존한다. 일반적인 공격은 막을 수 있겠지만 한국의 은행이나 정부기관을 목표로 하는 공격에 효과가 있을 가능성이 적다. 

이것을 그것을 만든 업체가 잘 못 해서가 아니다 (물론 잘못한 것이 있다).
일반적인 원칙으로 이미 보안이 뚫린 환경에서 소프트웨어를 추가한다고 문제가 사라지지 않는다.
무엇을 하든지 주어진 환경에서 동작하는 악성 소프트웨어는 언제든 대항할 수 있는 방법을 마련할 수 있다.

이러한 것을 이미 20년 전 쯤 봤다.
은행 트로전이 유행했고 암호를 훔쳤다.
어떤 웹사이트는 화상키보드를 사용해서 물리적인 키보드에서 암호를 입력하지 않도록 했다.

은행 트로전은 빨리 적응해 단순히 눌려진 키를 저장하는 것 뿐만 아니라 마우스 클릭과 클리된 위치 주변의 스크린샷을 저장하였다.
이렇게 되면서 화상키보드는 무용지물이 되어 버렸다.
하지만 한국에서는 여전히 많이 사용된다.

다시 한 번 이야기한다.
컴퓨터의 보안이 뚫리면 더이상 조취를 취할 수 있는게 없다.
유일한 해결책은 [다중인증(Multi-Factor Authentication; MFA)](https://en.wikipedia.org/wiki/Multi-factor_authentication)이다.
온라인 뱅킹 환경에서는 세부 거래내역은 독립된 그리고 보안이 뚫리지 않은 디바이스에서 확인해야 한다.


## IP주소 감지

20년 전 나는 온라인 챗의 운영자였다.
대부분의 챗 방문자들은 점잖게 행동했지만, 일부는 다른 사람들을 괴롭히기만 하는 트롤이었다.
나는 트롤들의 IP 주소를 차단했지만, 곧 다른 IP 주소로 다시 돌아오곤 했다.

20년이 지난 지금도 한국의 은행들은 여전히 불충분한 방어 대책으로 어려움을 겪고 있는 것으로 보인다.
새로운 방법을 찾기 보단, 익명 프록시 및 VPN과 계속 싸우고 있다.
그 결과, 은행들은 고객들에게 [프라이버시를 침해하는 비익명화 도구인 IPinside 설치](https://palant.info/2023/01/25/ipinside-koreas-mandatory-spyware/)를 요구하고 있다.

솔직히 나는 이것이 정확히 어떤 위협에 대응하려는 것인지도 모르겠다.
단순히 고객 데이터를 더 많이 수집하기 위한 핑계가 아니고 위협을 막기 위한 것이라고 가정해보겠다.

은행은 일반적으로 로그인 시도를 제한할 때 IP 주소를 신경쓰지 않는다.
로그인 시도가 세 번 실패하면 계정이 잠기는 것이 일반적이기 때문에, 로그인 정보를 추측하는 것은 현실적으로 어렵다.

도용된 로그인 정보를 사용하는 사람을 식별하는 것이 목표일까?
하지만 이 또한 [다중 인증(multi-factor authentication) ](https://en.wikipedia.org/wiki/Multi-factor_authentication)으로 가장 잘 해결할 수 있는 문제다.
은행 시스템의 트로이 목마는 이런 지역 차단(geo-blocking)을 회피하는 방법을 오래 전에 배웠고, 사용자의 감염된 컴퓨터를 사용해 로그인 정보를 유출하고 악의적인 거래에 사용하기만 하면 된다.
은행이 보기에는 이 거래는 계좌의 합법적인 소유자가 사용하는 컴퓨터에서 발생한 것이다.

아니면 실제로 은행 웹사이트 자체의 취약점에 대한 공격을 방지해 공격 출처를 감지하고 차단하는 것이 목표일까?
하지만 로그인 전 은행 웹사이트에 접속하는 것은 IPinside가 필요하지 않으므로 여기서는 효과가 없다.
그리고 악의적인 공격자가 로그인한 후에는 은행에서 유출된 계정을 인지하고 잠글 수 있다.


## 인증서 기반 로그인

한국시장의 특이점 하나는 인증서기반 로그인이 많이 사용된다는 것이다.
한 때 온라인 뱅킹을 위해 강제되었던 것이지만 더이상 그렇지는 않다.
여전히 인증서를 관리하고 다른 디바이스간 이동을 할 수있도록 하는 애플리케이션이 여전히 존재한다.

인증서 기반 로그인은 웹브라우저에서 이미 지원한지 꽤 되었다 (클라이언트 인증 TLS 핸드쉐이크).
하지만 이 기능을 쓰는 웹사이트를 거의 보지 못했고 지난 5년간만을 보면 전혀 없었다.
이유는 명백하다: 이것은 악몽과 같은 사용자 경험을 제공한다.

일반인들이 암호에 대해서는 잘 이해하지만 인증서는 너무 복잡하다.
인증서를 백업하고 사용하는 모든 디바이스로 옮기는 과정에 오류가 발생할 가능성이 높다.

또한 뱅킹관련해서 부가적인 가치를 제공하는 것도 아니다.
이론적으로는 인증서가 암호보다는 훨씬 알아맞추가 어렵지만 3번 시도후 계정이 잠긴다면 실제 큰 효과가 없다.
암호에 추가로 인증서를 사용하는 것은 제대로된 2단계 인증이 아니다.
세부 거래내역을 보여주는 독립된 기기가 존재하지 않기 때문에 인증서가 무엇을 확인해 주는지 알 수 없다.

하지만 중요한 계정을 하드웨어 토큰을 사용해 보호하려면 웹브라우저는 [웹인증(WebAuthn) 프로토콜](https://en.wikipedia.org/wiki/WebAuthn) 이전부터 지원하고 있다.
이것을 사용하기 위해서는 다른 3자 애플리케이션이 필요없다.

## 소프트웨어 배포

보안문제가 없더라도 사용자들이 설치해야하는 애플리케이션이 많기에 상당한 문제들이 발생한다.
국가의 모든 은행에서 필수로 설치해야하는 애플리케이션이 하나라면 감당할 만 할 것이다.
웹사이트에 따라서 필요로하는 애플리케이션이 10개가 되고 알맞는 버전까지 고려해야한다면?
일반 사용자가 제대로 관리하기에는 불가능하다.

더군다나 소프트웨어 제공업체가 소프트웨어 배포를 안전하게 배포한 경험이 없는 은행에게 이것을 맡긴다.
그래서 은행 웹사이트에서 보안 소프트웨어를 다운로드 받는 경우 최신버전보다 몇 년 더 이 전 버전인 경우도 자주 보았다.
그리고 다운로드도 (암호화되지 않은) 일반 HTTP 경우도 있었다.
더 이상 사용되지 않는 아주 오래된 소프트웨어를 배포하는 버려진 웹페이지를 무시하더라도 말이다.

이것 때문에 내 취약점 공개 이후의 실행과정이 이미 문제가 된다.
소프트웨어 공급업체는 내가 신고한 보안문제에 대해 수정해야하지만 그 후 업데이트를 제대로 배포할 수 있는 방법이 없다.
각 은행에 소프트웨어를 업데이트하도록 요청해야하지만 적지 않은 은행 웹사이트가 최신 소프트웨어와 호환되지 않아 배포를 미룰 수도 있다. 이 난관을 넘어도 사용자가 업데이트를 수동으로 설치해야 한다.

_만약_ 여러 애플리케이션이 모두 필요하다고 해도 이것을 처리하기 위해 효과적인 자동업데이트 기능을 추가하는 것도 옵션이 될 수 있다. 사용자가 얼마나 오래된 버전을 설치해 사용하든지 곧 공급업체의 (보안상 안전한) 업데이트 서버에 접속해 가장 최신 버전을 설치할 것이다. 은행은 최신버전과 호환이 될 수 있도록 필요한 절차를 마련해야할 것이다. 오래되고 취약점이 존재하는 소프트웨어를 계속 사용하는 옵션은 가질 수 없다.

당연히도 한국에서는 이러한 해결책을 선택하지 않았다. 대신 Veraport가 있다. 이것은 여러 보안 애플리케이션을 관리하는 애플리케이션이다. 그리고 여전히 은행에서 무엇을 설치하고 언제 업데이트를 해야할지를 결정한다. 이것으로 문제가 해결되기는 커녕 [북한의 해커에게 악용](https://threatpost.com/hacked-software-south-korea-supply-chain-attack/161257/)되었다. 



